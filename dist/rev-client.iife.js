"use strict";var revClientLib=(()=>{var le=Object.defineProperty;var et=Object.getOwnPropertyDescriptor;var tt=Object.getOwnPropertyNames;var st=Object.prototype.hasOwnProperty;var nt=(t,i)=>{for(var s in i)le(t,s,{get:i[s],enumerable:!0})},it=(t,i,s,e)=>{if(i&&typeof i=="object"||typeof i=="function")for(let n of tt(i))!st.call(t,n)&&n!==s&&le(t,n,{get:()=>i[n],enumerable:!(e=et(i,n))||e.enumerable});return t};var ot=t=>it(le({},"__esModule",{value:!0}),t);var Tt={};nt(Tt,{RevClient:()=>G,RevError:()=>S,ScrollError:()=>j,default:()=>wt,utils:()=>Pt});var de={".7z":"application/x-7z-compressed",".asf":"video/x-ms-asf",".avi":"video/x-msvideo",".csv":"text/csv",".doc":"application/msword",".docx":"application/vnd.openxmlformats-officedocument.wordprocessingml.document",".f4v":"video/x-f4v",".flv":"video/x-flv",".gif":"image/gif",".jpg":"image/jpeg",".m4a":"audio/mp4",".m4v":"video/x-m4v",".mkv":"video/x-matroska",".mov":"video/quicktime",".mp3":"audio/mpeg",".mp4":"video/mp4",".mpg":"video/mpeg",".pdf":"application/pdf",".png":"image/png",".ppt":"application/vnd.ms-powerpoint",".pptx":"application/vnd.openxmlformats-officedocument.presentationml.presentation",".rar":"application/x-rar-compressed",".srt":"application/x-subrip",".svg":"image/svg+xml",".swf":"application/x-shockwave-flash",".ts":"video/mp2t",".txt":"text/plain",".wmv":"video/x-ms-wmv",".xls":"application/vnd.ms-excel",".xlsx":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",".zip":"application/zip",".mks":"video/x-matroska",".mts":"model/vnd.mts",".vtt":"text/vtt",".wma":"audio/x-ms-wma"};function me(t="",i="video/mp4"){return t=t.toLowerCase(),t&&t in de?de[t]:i}function ge(t,i=".mp4"){let s=t&&Object.entries(de).find(([e,n])=>t.startsWith(n));return s?s[0]:i}function Ee(t="upload",i="",s){i==="application/octet-stream"&&(i=""),/charset/.test(i)&&(i=i.replace(/;?.*charset.*$/,""));let e=t.replace(/\.[^\.]+$/,""),n=t.replace(e,"");return n||(n=ge(i||s||"")),t=`${e}${n}`,(!i||[".vtt",".srt"].includes(n))&&(i=me(n,s)),{filename:t,contentType:i}}var{toString:rt}=Object.prototype;function v(t){if(rt.call(t)!=="[object Object]")return!1;let i=Object.getPrototypeOf(t);return i===null||i===Object.getPrototypeOf({})}function $e(t){return typeof t?.stream=="function"}function ke(t){return`${t[0]}${t.slice(1)}`}var E={async string(t,i){let s=t instanceof URL?t:new URL(t,"invalid://");if(!/^data|blob|file/.test(s.protocol))throw new TypeError("Only Blob / DateURI URLs are supported");if(i.disableExternalResources&&s.protocol==="file:")throw new Error("file: protocol not allowed");let e=await(await y.fetch(s)).blob();return E.blob(e,i)},async stream(t,i){let{contentType:s}=i;if(!(t instanceof ReadableStream))throw new TypeError("Only Blob / Files are supported for file uploads. Pass a File/Blob object");let e=new Response(t,{headers:s?{"content-type":s}:{}});return E.response(e,i)},async response(t,i){let{body:s,headers:e}=t;if(!t.ok||!s)throw await S.create(t);return E.blob(await t.blob(),i)},async blob(t,i){let{filename:s=t.name??"upload",contentType:e=t.type??"",defaultContentType:n}=i,o=Ee(s,e,n);return t.type!==o.contentType&&typeof t.slice=="function"&&(t=new File([t],o.filename,{type:o.contentType})),{file:t,options:{...i,...t.size&&{contentLength:t.size},...o}}},async parse(t,i){if(typeof t=="string"||t instanceof URL)return E.string(t,i);if(t instanceof y.Response)return E.response(t,i);if(!$e(t))throw new TypeError("Only Blob / Files are supported for file uploads. Pass a File/Blob object");return E.blob(t,i)}};function U(t,i,s){t.append(i,JSON.stringify(s))}async function T(t,i,s,e={}){let{file:n,options:o}=await y.uploadParser.parse(s,e);return t.append(i,n,o.filename),o}async function A(t,i,s,e,n,o={}){let{headers:a}=o,r=new y.Headers(a);o.headers=r;let p=y.beforeFileUploadRequest(e,r,n,o),{body:c}=await t.request(i,s,p,o);return c}function at(t){let i=crypto.getRandomValues(new Uint8Array(t/2));return Array.from(i).map(s=>s.toString(16).padStart(2,"0")).join("")}async function pt(t){let i=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",i),e=String.fromCharCode(...new Uint8Array(s));return btoa(e).replace(/\//g,"_").replace(/\+/g,"-").replace(/=+$/,"")}async function ct(t,i){let s=new TextEncoder,e=await crypto.subtle.importKey("raw",s.encode(i),{name:"HMAC",hash:"SHA-256"},!0,["sign"]),n=await crypto.subtle.sign("HMAC",e,s.encode(t));return btoa(String.fromCharCode(...new Uint8Array(n)))}var fe={AbortController:globalThis.AbortController,AbortSignal:globalThis.AbortSignal,createAbortError(t){return new DOMException(t,"AbortError")},fetch(...t){return globalThis.fetch(...t)},FormData:globalThis.FormData,File:globalThis.File,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response,uploadParser:E,randomValues:at,sha256Hash:pt,hmacSign:ct,beforeFileUploadRequest(t,i,s,e){return t},asPlatformStream(t){return t},asWebStream(t){return t}},y=fe,B=!1,ye,he=[];function De(){return!!B}function Ce(){if(B)return ye||(ye=(async()=>{for(;he.length>0;){let t=he.shift();if(typeof t=="function")try{let i=await t(fe);Object.assign(fe,i)}catch{}}B=!1,ye=void 0})()),ye}function Ue(t){he.push(t),B=!0}var Fe=60*1e3;function ut(t,i={}){if(t&&typeof t=="object"&&(i=Object.assign({},t,i),t=void 0),t||(t=i.fn),typeof t!="function")throw new TypeError("Rate limit function is not a function");let{perSecond:s,perMinute:e,perHour:n,signal:o}=i,a=parseFloat(i.limit)||1,r=parseInt(i.interval,10);if(s&&(a=parseFloat(s),r=1e3),e&&(a=parseFloat(e),r=Fe),n&&(a=parseFloat(n),r=Fe*60),a<1?(r/=a,a=1):a=Math.floor(a),!Number.isFinite(a))throw new TypeError(`Invalid limit ${a}`);if(!Number.isFinite(r)||r<=0)throw new TypeError("Invalid interval option");let p=new Map,c=0,u=0,l=function(...g){let d;return new Promise((h,R)=>{let b=()=>{h(t.apply(null,g)),p.delete(d)},P=Date.now();P-c>r?(u=1,c=P):u<a?u++:(c+=r,u=1),d=setTimeout(b,c-P),p.set(d,R)})},m=o?()=>l.abort(o.reason?`${o.reason}`:void 0,!0):void 0;return l.abort=(g="Cancelled rate-limit queue",d=!1)=>{d&&o?.removeEventListener("abort",m);for(let[h,R]of p.entries())clearTimeout(h),R(y.createAbortError(g));p.clear()},o?.addEventListener("abort",m),l}var L=ut;var Re={get:24e3,post:3600,searchVideos:120,uploadVideo:30,updateVideo:30,videoDetails:2e3,attendeesRealtime:2,auditEndpoint:60,loginReport:10,viewReport:120},Ve=()=>Promise.resolve();function Le(t){return{...t&&Re,...typeof t=="object"&&t}}function ve(t,i){let s=Re[t],e=i??s;if(!isFinite(e)||e<=0)return Ve;let n=e/12;return L({fn:Ve,limit:n,interval:5e3})}function _e(t={}){let i=Object.keys(Re).map(s=>[s,ve(s,t[s])]);return Object.fromEntries(i)}function je(t,i){Object.values(t).forEach(e=>e.abort?.(i))}function F(t,i){return t?(t instanceof Date||(t=new Date(t)),isNaN(t.getTime())?i:t):i}async function We(t,i=()=>!0,s=3,e=1e3){let n=0;for(;n<s;)try{return await t()}catch(o){if(n+=1,n>=s||!i(o,n))throw o;await _(e)}}async function _(t,i){return new Promise(s=>{let e,n=()=>{clearTimeout(e),i?.removeEventListener("abort",n),s()};e=setTimeout(n,t),i?.addEventListener("abort",n)})}function D(t){if(t!=="null"&&t)try{return JSON.parse(t)}catch{}return null}var S=class t extends Error{constructor(i,s){let{status:e=500,statusText:n="",url:o}=i;if(super(`${e} ${n}`),"captureStackTrace"in Error&&Error.captureStackTrace(this,this.constructor),this.status=e,this.url=o,this.code=`${e}`,this.detail=n,v(s))s.code&&(this.code=s.code),s.detail&&(this.detail=s.detail);else if(typeof s=="string")if(s=s.trim(),s.startsWith("{")){let{code:a,detail:r}=D(s)||{};a&&(this.code=a),r&&(this.detail=r)}else this.status===429?this.detail="Too Many Requests":/^(<!DOCTYPE|<html)/.test(s)&&(this.detail=s.replace(/.*<body>\s+/s,"").replace(/<\/body>.*/s,"").slice(0,256))}get name(){return"RevError"}get[Symbol.toStringTag](){return"RevError"}static async create(i){let s;try{s=await i.text()}catch(e){s={code:"Unknown",detail:`Unable to parse error response body: ${e}`}}return new t(i,s)}},j=class extends Error{constructor(i=408,s="ScrollExpired",e="Timeout while fetching all results in search request"){super("Search Scroll Expired"),Error.captureStackTrace(this,this.constructor),this.status=i,this.code=s,this.detail=e}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}};var k=class{constructor(i={}){this.options={maxResults:1/0,onProgress:(s,e,n)=>{},onError:s=>{throw s},onScrollError:s=>{console.warn("DEPRECATED: use onError instead of onScrollError with rev search requests"),this.options.onError(s)},signal:void 0,...i},this.current=0,this.total=void 0,this.done=!1}async nextPage(){let{onProgress:i,onError:s,signal:e}=this.options;if(e?.aborted&&(this.done=!0),this.done)return{current:this.current,total:this.current,done:this.done,items:[]};let n=await this._requestPage(),o=this._parsePage(n),{current:a,items:r,total:p,done:c,error:u}=o;return i(r,a,p),u&&s(u),{current:a,items:r,total:p,done:c}}_parsePage(i){let{maxResults:s}=this.options,{items:e=[],done:n=this.done,total:o,pageCount:a,error:r}=i;n&&(this.done=!0),isFinite(o)&&(this.total=Math.min(o,s)),a||(a=e.length);let p=this.current;return p+a>=s&&(a=s-p,e=e.slice(0,a),this.done=!0),this.current+=a,this.current===this.total&&(this.done=!0),this.done&&(this.total=this.current),r&&(this.done=!0),{current:p,total:this.total,done:this.done,error:r,items:e}}async exec(){let i=[];for await(let s of this)i.push(s);return i}async*[Symbol.asyncIterator](){let{signal:i}=this.options;do{let{items:s}=await this.nextPage();for await(let e of s){if(i?.aborted)break;yield e}}while(!this.done)}};async function Ge(t,i){let s=t.headers.get("Content-Type")||i||"",e=t.headers.get("Content-Length");if(s.startsWith("application/json")&&e!=="0")try{return await t.json()}catch{}return s.startsWith("text")?t.text():t.body}var f=class extends k{constructor(i,s,e={},n={}){super({onProgress:(r,p,c)=>{let{hitsKey:u}=s;i.log("debug",`searching ${u}, ${p}-${p+r.length} of ${c}...`)},onError:r=>{throw r},...n});let{scrollId:o,...a}=e;this.query=a,this._reqImpl=this._buildReqFunction(i,s),this.current=0,this.total=1/0,this.done=!1}_requestPage(){return this._reqImpl()}_buildReqFunction(i,s){let{endpoint:e,totalKey:n,hitsKey:o,isPost:a=!1,request:r,transform:p}=s,c=r||(a?i.post.bind(i):i.get.bind(i));return async()=>{let u=await c(e,this.query,{responseType:"json"}),{scrollId:l,[n]:m,[o]:g=[],statusCode:d,statusDescription:h}=u,R=!1;this.query.scrollId=l,l||(R=!0);let b=typeof p=="function"?await Promise.resolve(p(g)):g;b.length===0&&(R=!0);let P=d>=400&&h?new j(d,h):void 0;return{total:m,done:R,pageCount:g.length,items:b,error:P}}}};function H(t){let i,s,e={async roles(n=!0){if(i&&n===!0)return i;let o=await t.get("/api/v2/users/roles");return n&&(i=o),o},async getRoleByName(n,o=!0){let a=await e.roles(o),r=a.find(p=>p.roleType===n||p.name===n);if(!r)throw new TypeError(`Invalid Role Name ${n}. Valid values are: ${a.flatMap(p=>p.roleType?[p.roleType,p.name]:[p.name]).join(", ")}`);return{id:r.id,name:r.roleType||r.name}},async customFields(n=!0){if(s&&n===!0)return s;let o=await t.get("/api/v2/video-fields",void 0,{responseType:"json"});return n&&(s=o),o},async getCustomFieldByName(n,o=!0){let a=await e.customFields(o),r=a.find(p=>p.name===n);if(!r)throw new TypeError(`Invalid Custom Field Name ${n}. Valid values are: ${a.map(p=>p.name).join(", ")}`);return r},async brandingSettings(){return t.get("/api/v2/accounts/branding-settings")},async webcastRegistrationFields(){return(await t.get("/api/v2/accounts/webcast-registration-fields")).registrationFields},async createWebcastRegistrationField(n){return(await t.post("/api/v2/accounts/webcast-registration-fields",n)).fieldId},async updateWebcastRegistrationField(n,o){return t.put(`/api/v2/accounts/webcast-registration-fields/${n}`,o)},async deleteWebcastRegistrationField(n){return t.delete(`/api/v2/accounts/webcast-registration-fields/${n}`)},listIQCreditsUsage(n,o){let a={endpoint:"/api/v2/analytics/accounts/iq-credits-usage",totalKey:"total",hitsKey:"sessions"};return new f(t,a,n,o)},async verifySystemHealth(){return await t.get("/api/v2/system-health"),!0},async maintenanceSchedule(){let{schedules:n}=await t.get("/api/v2/maintenance-schedule");return n},async userLocationService(){return t.get("/api/v2/user-location")},async expirationRules(){return t.get("/api/v2/expiration-rules")},async featureSettings(n){let o=n?{videoId:n}:void 0;return t.get("/api/v2/videos/feature-settings",o)}};return e}function Be(t){t=t.replace(/(\r\n|\n|\r)/gm,`
`).replace(/\n$/g,"");let i="",s=!1,e=!1,n="",o=[],a=[],r,p=t.length;function c(l){if(e)return l;if(l!=="")return l.trim()}for(r=0;r<p;r+=1)i=t.charAt(r),!s&&(i===","||i===`
`)?(n=c(n),o.push(n),i===`
`&&(a.push(o),o=[]),n="",e=!1):i==='"'?s?t.charAt(r+1)==='"'?(n+='"',r+=1):s=!1:(s=!0,e=!0):n+=i===`
`?`
`:i;n=c(n),o.push(n),a.push(o);let u=a.shift();return a.map(l=>{let m={};return l.forEach((g,d)=>{g!==void 0&&(m[u[d]]=g)}),m})}function lt(t){return{messageKey:t.MessageKey,entityKey:t.EntityKey,when:t.When,entityId:t.EntityId,principal:D(t.Principal)||{},message:D(t.Message)||{},currentState:D(t.CurrentState)||{},previousState:D(t.PreviousState)||{}}}var w=class extends k{constructor(i,s,e="audit records",{toDate:n,fromDate:o,beforeRequest:a,...r}={}){super({onProgress:(u,l,m)=>{i.log("debug",`loading ${e}, ${l} of ${m}...`)},...r});let{from:p,to:c}=this._parseDates(o,n);this.params={toDate:c.toISOString(),fromDate:p.toISOString()},this._req=this._buildReqFunction(i,s,a)}_requestPage(){return this._req()}_buildReqFunction(i,s,e){return async()=>{await e?.(this);let n=await i.request("GET",s,this.params,{responseType:"text"}),{body:o,headers:a}=n,r=Be(o).map(u=>lt(u)),p=parseInt(a.get("totalRecords")||"",10);Object.assign(this.params,{nextContinuationToken:a.get("nextContinuationToken")||void 0,fromDate:a.get("nextfromDate")||void 0});let c=!this.params.nextContinuationToken;return{items:r,total:Math.max(this.total||0,p),done:c}}}_parseDates(i,s){let e=F(s,new Date),n=new Date(e);n.setFullYear(e.getFullYear()-1);let o=F(i,n);return e<o&&([e,o]=[o,e]),{from:o,to:e}}};function M(t,i){let s=Le(i).auditEndpoint;function e(){if(!s)return r=>r;let a=ve("auditEndpoint",s);return(r={})=>({...r,async beforeRequest(p){return await a(),r.beforeRequest?.(p)}})}let n={accountAccess:e(),userAccess:e(),accountUsers:e(),user:e(),accountGroups:e(),group:e(),accountDevices:e(),device:e(),accountVideos:e(),video:e(),accountWebcasts:e(),webcast:e(),principal:e()};return{accountAccess(a,r){let p=n.accountAccess(r);return new w(t,`/network/audit/accounts/${a}/userAccess`,"UserAccess",p)},userAccess(a,r,p){let c=n.userAccess(p);return new w(t,`/network/audit/accounts/${r}/userAccess/${a}`,`UserAccess_${a}`,c)},accountUsers(a,r){let p=n.accountUsers(r);return new w(t,`/network/audit/accounts/${a}/users`,"User",p)},user(a,r,p){let c=n.user(p);return new w(t,`/network/audit/accounts/${r}/users/${a}`,"User",c)},accountGroups(a,r){let p=n.accountGroups(r);return new w(t,`/network/audit/accounts/${a}/groups`,"Groups",p)},group(a,r,p){let c=n.group(p);return new w(t,`/network/audit/accounts/${r}/groups/${a}`,"Group",c)},accountDevices(a,r){let p=n.accountDevices(r);return new w(t,`/network/audit/accounts/${a}/devices`,"Devices",p)},device(a,r,p){let c=n.device(p);return new w(t,`/network/audit/accounts/${r}/devices/${a}`,"Device",c)},accountVideos(a,r){let p=n.accountVideos(r);return new w(t,`/network/audit/accounts/${a}/videos`,"Videos",p)},video(a,r,p){let c=n.video(p);return new w(t,`/network/audit/accounts/${r}/videos/${a}`,"Video",c)},accountWebcasts(a,r){let p=n.accountWebcasts(r);return new w(t,`/network/audit/accounts/${a}/scheduledEvents`,"Webcasts",p)},webcast(a,r,p){let c=n.webcast(p);return new w(t,`/network/audit/accounts/${r}/scheduledEvents/${a}`,"Webcast",c)},principal(a,r,p){let c=n.principal(p);return new w(t,`/network/audit/accounts/${r}/principals/${a}`,"Principal",c)}}}function V(t,i){let s=new y.Headers(t);return new y.Headers(i).forEach((e,n)=>s.set(n,e)),s}var dt="http://rev";function He(t,i,s){let e=new URL("/api/v2/oauth2/authorize",t.revUrl);return e.search=new URLSearchParams({client_id:t.oauthApiKey,code_challenge:i,response_type:"code",redirect_uri:t.redirectUri,...s&&{state:s}}).toString(),e.toString()}async function Me(t=y.randomValues(48)){let i=await y.sha256Hash(t);return{codeVerifier:t,codeChallenge:i}}async function be(t,i,s="1"){let{hmacSign:e}=y,n="code",{oauthApiKey:o,redirectUri:a}=t,p=`${o}::${new Date().toISOString()}`,c=await e(p,i);return{apiKey:o,signature:c,verifier:p,redirect_uri:a,response_type:n,state:s}}function Ke(t){typeof t=="string"&&(t=new URL(t,dt)),t instanceof URL&&(t=t.searchParams);let i=t instanceof URLSearchParams?Object.fromEntries(t):t,{auth_code:s="",state:e="",error:n=void 0}=i;return{isSuccess:!n,authCode:`${s}`.replace(/ /g,"+"),state:e,error:n}}function K(t){let i={async loginToken(s,e,n){return t.post("/api/v2/authenticate",{apiKey:s,secret:e},n)},async extendSessionToken(s){return t.post(`/api/v2/auth/extend-session-timeout/${s}`)},async logoffToken(s){return t.delete(`/api/v2/tokens/${s}`)},async loginUser(s,e,n){return t.post("/api/v2/user/login",{username:s,password:e},n)},async logoffUser(s){return t.post("/api/v2/user/logoff",{userId:s})},async extendSessionUser(s){return t.post("/api/v2/user/extend-session-timeout",{userId:s})},async loginJWT(s,e){return t.get("/api/v2/jwtauthenticate",{jwt_token:s},e)},async loginGuestRegistration(s,e,n){let o={...n,headers:V(n?.headers,{"x-requested-with":"xmlhttprequest"})};return t.post(`/external/auth/jwt/${s}`,{token:`vbrick_rev ${e}`},n)},async extendSession(){return t.post("/api/v2/user/extend-session")},async verifySession(){return t.get("/api/v2/user/session")},get logoutUser(){return i.logoffUser},get logoutToken(){return i.logoffToken},async buildOAuth2Authentication(s,e="1",n){let{codeChallenge:o,codeVerifier:a}=await Me(n);return{url:`${He(s,o,e)}`,codeVerifier:a}},async loginOAuth2(s,e,n,o){return t.post("/api/v2/oauth2/token",{code:e.replace(/ /g,"+"),client_id:s.oauthApiKey,grant_type:"authorization_code",redirect_uri:s.redirectUri,code_verifier:n},o)},async buildOAuthAuthenticationURL(s,e,n="1"){let o=await be(s,e,n),a=new URL("/api/v2/oauth/authorization",t.url);return a.search=`${new URLSearchParams(o)}`,`${a}`},buildOAuthAuthenticationQuery:be,parseOAuthRedirectResponse:Ke,async loginOAuth(s,e){let n="authorization_code",{oauthApiKey:o,redirectUri:a}=s;return e=e.replace(/ /g,"+"),t.post("/api/v2/oauth/token",{authCode:e,apiKey:o,redirectUri:a,grantType:n})},async extendSessionOAuth(s,e){let n="refresh_token",{oauthApiKey:o}=s;return t.post("/api/v2/oauth/token",{apiKey:o,refreshToken:e,grantType:n})}};return i}function N(t){return{async create(s){return t.post("/api/v2/categories",s,{responseType:"json"})},async details(s){return t.get(`/api/v2/categories/${s}`,void 0,{responseType:"json"})},async update(s,e){return t.put(`/api/v2/categories/${s}`,e)},async delete(s){return t.delete(`/api/v2/categories/${s}`)},async list(s,e){let n=Object.assign({},s&&{parentCategoryId:s},e!=null&&{includeAllDescendants:e}),{categories:o}=await t.get("/api/v2/categories",n,{responseType:"json"});return o},async listAssignable(){return t.get("/api/v2/assignable-categories")}}}function z(t){return{async create(s){let{channelId:e}=await t.post("/api/v2/channels",s,{responseType:"json"});return e},async update(s,e){return t.put(`/api/v2/channels/${s}`,e)},async delete(s){return t.delete(`/api/v2/channels/${s}`)},list(s=0,e={}){return new Pe(t,s,e)},async addMembers(s,e){let n=e.map(o=>({op:"add",path:"/Members/-",value:o}));await t.patch(`/api/v2/channels/${s}`,n)},async removeMembers(s,e){let n=e.map(o=>({op:"remove",path:"/Members",value:typeof o=="string"?o:o.id}));await t.patch(`/api/v2/channels/${s}`,n)},get uploadLogo(){return t.upload.channelLogo},search(s,e={}){let n={endpoint:`/api/v2/search/access-entity${e?.assignable?"/assignable":""}`,totalKey:"totalEntities",hitsKey:"accessEntities"},o={type:e.type||"Channel",...s&&{q:s}};return new f(t,n,o,e)}}}var Pe=class{constructor(i,s=0,e={}){this.options={maxResults:1/0,pageSize:10,onProgress:(n,o,a)=>{i.log("debug",`loading channels, ${o} of ${a}...`)},...e},this.current=0,this.total=1/0,this.done=!1,this.currentPage=s,this._req=()=>{let n={page:this.currentPage,size:this.options.pageSize};return i.get("/api/v2/channels",n,{responseType:"json"})}}async nextPage(){let{maxResults:i,onProgress:s}=this.options,e=this.current,n=await this._req();if((!Array.isArray(n)||n.length==0)&&(this.done=!0,n=[]),e+n.length>=i){let o=i-e;n=n.slice(0,o),this.done=!0}return this.total=e+n.length,s(n,e,this.total),this.current+=n.length,this.currentPage+=1,{current:e,total:this.total,done:this.done,items:n}}async exec(){let i=[];for await(let s of this)i.push(s);return i}async*[Symbol.asyncIterator](){do{let{items:i}=await this.nextPage();for await(let s of i)yield s}while(!this.done)}};function J(t){return{async listDMEs(){return(await t.get("/api/v2/devices/dmes")).devices},async listZoneDevices(){return(await t.get("/api/v2/zonedevices")).devices},async listPresentationProfiles(){return t.get("/api/v2/presentation-profiles")},async add(s){return t.post("/api/v2/devices/dmes",s)},async healthStatus(s){return t.get(`/api/v2/devices/dmes/${s}/health-status`)},async delete(s){return t.delete(`/api/v2/devices/dmes/${s}`)},async rebootDME(s){return t.put(`/api/v2/devices/dmes/${s}`)}}}function Q(t){let i={async create(s){let{groupId:e}=await t.post("/api/v2/groups",s);return e},async delete(s){await t.delete(`/api/v2/groups/${s}`)},async details(s){return t.get(`/api/v2/groups/${s}`)},search(s,e={}){let n={endpoint:`/api/v2/search/access-entity${e?.assignable?"/assignable":""}`,totalKey:"totalEntities",hitsKey:"accessEntities",transform:a=>a.map(mt)},o={type:"group"};return s&&(o.q=s),new f(t,n,o,e)},list(s={}){return i.search(void 0,s)},listUsers(s,e={}){let n={endpoint:`/api/v2/search/groups/${s}/users`,totalKey:"totalUsers",hitsKey:"userIds"};return new f(t,n,void 0,e)},listUserDetails(s,e={}){let n={endpoint:`/api/v2/search/groups/${s}/users`,totalKey:"totalUsers",hitsKey:"userIds",transform:async o=>{let a=[];for(let r of o){let p={userId:r};try{let c=await t.user.details(r);Object.assign(p,c)}catch(c){p.error=c}a.push(p)}return a}};return new f(t,n,void 0,e)}};return i}function mt(t){return{id:t.Id,name:t.Name,entityType:t.EntityType}}function gt(t,i){let s=["scrollId","statusCode","statusDescription"];return Object.fromEntries(Object.entries(t).filter(([n,o])=>!(n===i||s.includes(n)||Array.isArray(o))))}var Z=class extends f{constructor(s,e,n={},o={}){let a={endpoint:`/api/v2/playlists/${e}`,totalKey:"totalVideos",hitsKey:"videos",request:async(r,p,c)=>{await s.session.queueRequest("searchVideos");let u=await s.get(r,p,c);return Object.assign(this.playlist,gt(u,"videos")),u}};super(s,a,n,o);this.playlist={}}get playlistName(){return this.playlist.playlistDetails?.name||this.playlist.name}get searchFilter(){return this.playlist?.playlistType==="Dynamic"?this.playlist.playlistDetails?.searchFilter||this.playlist.searchFilter:void 0}async getPlaylistInfo(){this.options.maxResults=0;let{items:s}=await this.nextPage();return{...this.playlist,...this.playlist?.playlistDetails,videos:s,playlistName:this.playlistName,searchFilter:this.searchFilter}}};function Y(t){return{async create(s,e){let o=Array.isArray(e)?{name:s,playlistType:"Static",videoIds:e}:{name:s,playlistType:"Dynamic",playlistDetails:e},{playlistId:a}=await t.post("/api/v2/playlists",o,{responseType:"json"});return a},async details(s,e){return t.get(`/api/v2/playlists/${s}`,e,{responseType:"json"})},listVideos(s,e,n){return new Z(t,s,e,n)},async update(s,e){let o=Array.isArray(e)?{playlistVideoDetails:e}:{playlistDetails:e};return t.put(`/api/v2/playlists/${s}`,o)},async updateFeatured(s){let e={playlistVideoDetails:s};return t.put("/api/v2/playlists/featured-playlist",e)},async delete(s){return t.delete(`/api/v2/playlists/${s}`)},async list(){function s(r){let{id:p,playlistId:c,featurePlaylistId:u,featuredPlaylist:l,name:m,playlistName:g,...d}=r;return{...d,id:p??c??u??l,name:m??g,videos:r.videos??r.Videos}}let e=await t.get("/api/v2/playlists",void 0,{responseType:"json"}),n=!Array.isArray(e),a={playlists:(n?e.playlists:e).map(s)};return n&&(v(e.featuredPlaylist)?a.featuredPlaylist=s(e.featuredPlaylist):Array.isArray(e.videos)&&(a.featuredPlaylist=s(e))),a}}}function X(t){return{async startVideoConferenceRecording(s,e,n){let{videoId:o}=await t.post("/api/v2/vc/start-recording",{title:n,sipAddress:s,sipPin:e},{responseType:"json"});return o},async getVideoConferenceStatus(s){let{status:e}=await t.get(`/api/v2/vc/recording-status/${s}`,void 0,{responseType:"json"});return e},async stopVideoConferenceRecording(s){let e={videoId:s},n=await t.post("/api/v2/vc/stop-recording",e,{responseType:"json"});return v(n)?n.message:n},async startPresentationProfileRecording(s){let{scheduledRecordingId:e}=await t.post("/api/v2/pp/start-recording",s,{responseType:"json"});return e},async getPresentationProfileStatus(s){return await t.get(`/api/v2/pp/recording-status/${s}`,void 0,{responseType:"json"})},async stopPresentationProfileRecording(s){let e={scheduledRecordingId:s};return await t.get("/api/v2/vc/recording-status",e,{responseType:"json"})}}}function O(t,i){let{filename:s,contentType:e,contentLength:n,useChunkedTransfer:o,defaultContentType:a=i,...r}=t;return{requestOptions:r,uploadOptions:{filename:s,contentType:e,contentLength:n,useChunkedTransfer:o,defaultContentType:a}}}function ee(t){let{FormData:i}=y;return{async video(e,n={uploader:t.session.username??""},o={}){let{uploadOptions:a,requestOptions:r}=O(o,"video/mp4"),p=new i;if(!n.uploader){let l=t.session.username;if(l)n.uploader=l;else throw new TypeError("metadata must include uploader parameter")}U(p,"video",n);let c=await T(p,"VideoFile",e,a);t.log("info",`Uploading ${c.filename} (${c.contentType})`),await t.session.queueRequest("uploadVideo");let{videoId:u}=await A(t,"POST","/api/v2/uploads/videos",p,c,r);return u},async replaceVideo(e,n,o={}){let{uploadOptions:a,requestOptions:r}=O(o,"video/mp4"),p=new i,c=await T(p,"VideoFile",n,a);t.log("info",`Replacing ${e} with ${c.filename} (${c.contentType})`),await t.session.queueRequest("uploadVideo"),await A(t,"PUT",`/api/v2/uploads/videos/${e}`,p,c,r)},async transcription(e,n,o="en",a={}){let{uploadOptions:r,requestOptions:p}=O(a,"application/x-subrip"),c=new i,u=o.toLowerCase();(r.contentType==="text/plain"||r.filename?.endsWith("txt"))&&(r.filename=`${r.filename||"upload"}.srt`);let l=await T(c,"File",n,r),m={files:[{language:u,fileName:l.filename}]};U(c,"TranscriptionFiles",m),t.log("info",`Uploading transcription to ${e} ${u} ${l.filename} (${l.contentType})`),await A(t,"POST",`/api/v2/uploads/transcription-files/${e}`,c,l,p)},async supplementalFile(e,n,o={}){let{uploadOptions:a,requestOptions:r}=O(o),p=new i,c=await T(p,"File",n,a),u={files:[{fileName:c.filename}]};U(p,"SupplementalFiles",u),t.log("info",`Uploading supplemental content to ${e} ${c.filename} (${c.contentType})`),await A(t,"POST",`/api/v2/uploads/supplemental-files/${e}`,p,c,r)},async chapters(e,n,o="replace",a={}){let{uploadOptions:r,requestOptions:p}=O(a,"image/png"),c=new i,u={chapters:[]};for(let m of n){let{title:g,time:d,imageFile:h,uploadOptions:R={}}=m,b={time:d};if(g&&(b.title=g),h){let P=await T(c,"File",h,{...r,...R});b.imageFile=P.filename}u.chapters.push(b)}U(c,"Chapters",u),t.log("info",`${o==="replace"?"Uploading":"Updating"} ${u.chapters.length} chapters to ${e}`),await A(t,o==="replace"?"POST":"PUT",`/api/v2/uploads/chapters/${e}`,c,r,p)},async thumbnail(e,n,o={}){let{uploadOptions:a,requestOptions:r}=O(o,"image/jpeg"),p=new i,c=await T(p,"ThumbnailFile",n,a);t.log("info",`Uploading thumbnail for ${e} ${c.filename} (${c.contentType})`),await A(t,"POST",`/api/v2/uploads/images/${e}`,p,c,r)},async presentationChapters(e,n,o={}){let{uploadOptions:a,requestOptions:r}=O(o,"application/vnd.ms-powerpoint"),p=new i,c=await T(p,"PresentationFile",n,a);t.log("info",`Uploading presentation for ${e} ${c.filename} (${c.contentType})`),await A(t,"POST",`/api/v2/uploads/video-presentations/${e}`,p,c,r)},async webcastPresentation(e,n,o){let{uploadOptions:a,requestOptions:r}=O(o,"application/vnd.ms-powerpoint"),p=new i,c=await T(p,"PresentationFile",n,a);t.log("info",`Uploading presentation for ${e} ${c.filename} (${c.contentType})`),await A(t,"POST",`/api/v2/uploads/presentations/${e}`,p,c,r)},async webcastBackground(e,n,o){let{uploadOptions:a,requestOptions:r}=O(o,"image/jpeg"),p=new i,c=await T(p,"ImageFile",n,a);t.log("info",`Uploading background image for ${e} ${c.filename} (${c.contentType})`),await A(t,"POST",`/api/v2/uploads/background-image/${e}`,p,c,r)},async webcastProducerLayoutBackground(e,n,o){let{uploadOptions:a,requestOptions:r}=O(o,"image/jpeg"),p=new i,c=await T(p,"ImageFile",n,a);t.log("info",`Uploading producer layout background image for ${e} ${c.filename} (${c.contentType})`),await A(t,"POST",`/api/v2/uploads/webcast-producer-bgimage/${e}`,p,c,r)},async webcastBranding(e,n,o={}){let{uploadOptions:a,requestOptions:r}=O(o,"image/jpeg"),p=new i,c={...a,filename:"logo",...n.logoImageOptions??{}},u={...a,filename:"background",...n.logoImageOptions??{}},l=await T(p,"LogoImageFile",n.logoImage,c),m=await T(p,"BackgroundImageFile",n.backgroundImage,u),g={...n.branding,logoImageFilename:l.filename,backgroundImageFilename:m.filename};U(p,"Branding",g),t.log("info",`Uploading webcast branding to ${e} (${g.logoImageFilename} ${g.backgroundImageFilename})`),await A(t,"POST",`/api/v2/uploads/webcast-branding/${e}`,p,a,r)},async channelLogo(e,n,o={}){let{uploadOptions:a,requestOptions:r}=O(o,"image/jpeg"),p=new i,c=await T(p,"ImageFile",n,a);t.log("info",`Uploading channel logo for ${e} (${c.filename} ${c.contentType})`),await A(t,"POST",`/api/v2/uploads/channel-logo/${e}`,p,c,r)},async userProfileImage(e,n,o={}){let{uploadOptions:a,requestOptions:r}=O(o,"image/jpeg"),p=new i,c=await T(p,"ImageFile",n,a);await A(t,"POST",`/api/v2/uploads/profile-image/${e}`,p,c,r)}}}function te(t){async function i(e,n={}){let{lookupType:o,...a}=typeof n=="string"?{lookupType:n}:n,r=o==="username"||o==="email"?{type:o}:void 0;return t.get(`/api/v2/users/${e}`,r,{...a,responseType:"json"})}let s={get roles(){return t.admin.roles},async create(e){let{userId:n}=await t.post("/api/v2/users",e);return n},async delete(e){await t.delete(`/api/v2/users/${e}`)},details:i,async profile(e){return i("me",e)},async getByUsername(e){return s.details(e,{lookupType:"username"})},async getByEmail(e){return s.details(e,{lookupType:"email"})},async exists(e,n){let o=n==="username"||n==="email"?{type:n}:void 0,a=await t.request("GET",`/api/v2/users/${e}`,o,{responseType:"json",throwHttpErrors:!1});return a.statusCode===200?a.body:!1},async addToGroup(e,n){let o=[{op:"add",path:"/GroupIds/-",value:n}];await t.patch(`/api/v2/users/${e}`,o)},async removeFromGroup(e,n){let o=[{op:"remove",path:"/GroupIds",value:n}];await t.patch(`/api/v2/users/${e}`,o)},async suspend(e){let n=[{op:"replace",path:"/ItemStatus",value:"Suspended"}];await t.patch(`/api/v2/users/${e}`,n)},async unsuspend(e){let n=[{op:"replace",path:"/ItemStatus",value:"Active"}];await t.patch(`/api/v2/users/${e}`,n)},search(e,n={}){let{assignable:o=!1}=n,a={endpoint:`/api/v2/search/access-entity${o?"/assignable":""}`,totalKey:"totalEntities",hitsKey:"accessEntities",transform:p=>p.map(yt)},r={type:"user"};return e&&(r.q=e),new f(t,a,r,n)},async listSubscriptions(){return t.get("/api/v2/users/subscriptions")},async subscribe(e,n){return t.post("/api/v2/users/subscribe",{id:e,type:n})},async unsubscribe(e,n){return t.post("/api/v2/users/unsubscribe",{id:e,type:n})},async getNotifications(e=!1){return t.get("/api/v2/users/notifications",{unread:e})},async markNotificationRead(e){await t.put("/api/v2/users/notifications",e?{notificationId:e}:void 0)},async loginReport(e,n){let o={...e&&{sortField:e},...n&&{sortOrder:n}};await t.session.queueRequest("loginReport");let{Users:a}=await t.get("/api/v2/users/login-report",o,{responseType:"json"});return a},get uploadProfileImage(){return t.upload.userProfileImage},deleteProfileImage(e){return t.delete(`/api/v2/users/${e}/profile-image`)}};return s}function yt(t){return{userId:t.Id,entityType:t.EntityType,email:t.Email,firstname:t.FirstName,lastname:t.LastName,username:t.UserName,profileImageUri:t.ProfileImageUri}}var Ne=30,ft="asc";function se(t,i){let s=new Date(t.getTime());return s.setDate(s.getDate()+i),s}function ht(t){let{incrementDays:i=Ne,sortDirection:s=ft,videoIds:e,startDate:n,endDate:o,...a}=t;return i=Math.min(Math.max(1/24/60,parseFloat(i)||Ne),30),Array.isArray(e)&&(e=e.map(r=>r.trim()).filter(Boolean).join(",")),{incrementDays:i,sortDirection:s,videoIds:e,...Rt(n,o),...a}}function Rt(t,i){let s=new Date,e=F(t),n=F(i);return n||(e?(n=se(e,30),n.getTime()>s.getTime()&&(n=s)):n=s),e||(e=se(n,-30)),e.getTime()>n.getTime()&&([e,n]=[n,e]),{startDate:e,endDate:n}}var ne=class extends k{constructor(i,s={},e="/api/v2/videos/report"){super(ht(s)),this._endpoint=e,this._rev=i}async _requestPage(){let{startDate:i,endDate:s}=this,{incrementDays:e,sortDirection:n,videoIds:o}=this.options,a=n==="asc",r=i,p=s,c=!1;a?(p=se(r,e),p>=s&&(c=!0,p=s)):(r=se(p,-1*e),r<=i&&(c=!0,r=i));let u={after:r.toJSON(),before:p.toJSON()};o&&(u.videoIds=o),await this._rev.session.queueRequest("viewReport");let l=await this._rev.get(this._endpoint,u,{responseType:"json"});return c||(a?this.startDate=p:this.endDate=r),{items:l,done:c}}get startDate(){return this.options.startDate}set startDate(i){this.options.startDate=i}get endDate(){return this.options.endDate}set endDate(i){this.options.endDate=i}};function ze(t){function i(e,n={}){return v(e)?n=e:typeof e=="string"&&(n={...n??{},videoIds:e}),new ne(t,n,"/api/v2/videos/report")}function s(e,n,o=new Date,a){let r=n?{after:new Date(n).toISOString(),before:new Date(o??Date.now())}:void 0;return t.get(`/api/v2/videos/${e}/summary-statistics`,r,a)}return{report:i,uniqueSessionsReport(e,n={}){return new ne(t,n,`/api/v2/videos/${e}/report`)},summaryStatistics:s}}function Je(t){async function i(r,p={}){return await t.request("GET",`/api/v2/videos/${r}/download`,void 0,{responseType:"stream",...p})}async function s(r,p={}){let{imageUrl:c}=r,{body:u}=await t.request("GET",c,void 0,{responseType:"blob",...p});return u}async function e(r,p,c){let u=v(r)?r.downloadUrl:`/api/v2/videos/${r}/supplemental-files/${p}`,l=v(p)?p:c,{body:m}=await t.request("GET",u,void 0,{responseType:"blob",...l});return m}async function n(r,p,c){let u=v(r)?r.downloadUrl:`/api/v2/videos/${r}/transcription-files/${p}`,l=v(p)?p:c,{body:m}=await t.request("GET",u,void 0,{responseType:"blob",...l});return m}async function o(r,p={}){let{videoId:c="",imageId:u=""}=typeof r=="string"?{imageId:r}:r;if(!(c||u))throw new TypeError("No video/image specified to download");let l="";c?l=`/api/v2/videos/${c}/thumbnail`:u.startsWith("http")?l=`${u}${u.endsWith(".jpg")?"":".jpg"}`:l=`/api/v2/media/videos/thumbnails/${u}.jpg`;let{body:m}=await t.request("GET",l,void 0,{responseType:"blob",...p});return m}async function a(r,p){let c="";if(typeof r=="string")c=r;else if(r&&typeof r=="object"&&"thumbnailSheetsUri"in r)c=r.thumbnailSheetsUri;else if(r?.videoId){let{videoId:l,sheetIndex:m="1"}=r;c=`/api/v2/videos/${l}/thumbnail-sheets/${m}`}if(!c)throw new TypeError("No thumbnail sheet specified to download");let{body:u}=await t.request("GET",c,void 0,{responseType:"blob",...p});return u}return{download:i,downloadChapter:s,downloadSupplemental:e,downloadThumbnail:o,downloadTranscription:n,downloadThumbnailSheet:a}}function Qe(t){return{listExternalAccess(i,s,e){let n={endpoint:`/api/v2/videos/${i}/external-access`,totalKey:"total",hitsKey:"items"},o=s?{q:s}:void 0;return new f(t,n,o,e)},async createExternalAccess(i,s){await t.post(`/api/v2/videos/${i}/external-access`,s)},async renewExternalAccess(i,s){return t.put(`/api/v2/videos/${i}/external-access`,s)},async deleteExternalAccess(i,s){return t.delete(`/api/v2/videos/${i}/external-access`,s)},async revokeExternalAccess(i,s){return t.put(`/api/v2/videos/${i}/external-access/revoke`,s)}}}function ie(t){async function i(e,n=!1){return(await t.get(`/api/v2/videos/${e}/comments`,n?{showAll:"true"}:void 0)).comments}let s={async setTitle(e,n){let o=[{op:"add",path:"/Title",value:n}];await t.session.queueRequest("updateVideo"),await t.patch(`/api/v2/videos/${e}`,o)},async setCustomField(e,n){let o=[{op:"replace",path:"/CustomFields",value:[n]}];await t.session.queueRequest("updateVideo"),await t.patch(`/api/v2/videos/${e}`,o)},async delete(e,n){await t.session.queueRequest("updateVideo"),await t.delete(`/api/v2/videos/${e}`,void 0,n)},async status(e,n){return t.get(`/api/v2/videos/${e}/status`,void 0,n)},async details(e,n){return await t.session.queueRequest("videoDetails"),t.get(`/api/v2/videos/${e}/details`,void 0,n)},async update(e,n,o){await t.session.queueRequest("updateVideo"),await t.put(`/api/v2/videos/${e}`,n,o)},comments:i,async chapters(e,n){try{let{chapters:o}=await t.get(`/api/v2/videos/${e}/chapters`,void 0,n);return o}catch(o){if(o instanceof S&&o.code==="NoVideoChapters")return[];throw o}},async supplementalFiles(e,n){let{supplementalFiles:o}=await t.get(`/api/v2/videos/${e}/supplemental-files`,void 0,n);return o},async thumbnailConfiguration(e,n){let{thumbnailCfg:o}=await t.get(`/api/v2/videos/${e}/thumbnail-config`,void 0,n);return o},async transcriptions(e,n){let{transcriptionFiles:o}=await t.get(`/api/v2/videos/${e}/transcription-files`,void 0,n);return o},get upload(){return t.upload.video},get replace(){return t.upload.replaceVideo},async migrate(e,n,o){await t.session.queueRequest("updateVideo"),await t.put(`/api/v2/videos/${e}/migration`,n,o)},search(e={},n={}){let o={endpoint:"/api/v2/videos/search",totalKey:"totalVideos",hitsKey:"videos",async request(r,p,c){return await t.session.queueRequest("searchVideos"),t.get(r,p,c)}};return new f(t,o,e,n)},searchDetailed(e={},n={}){let o={endpoint:"/api/v2/videos/search",totalKey:"totalVideos",hitsKey:"videos",transform:async r=>{let p=[];for(let c of r){let u=c;try{let l=await s.details(c.id);Object.assign(u,l)}catch(l){u.error=l}p.push(u)}return p}};return new f(t,o,e,n)},async playbackInfo(e){let{video:n}=await t.get(`/api/v2/videos/${e}/playback-url`);return n},async playbackUrls(e,{ip:n,userAgent:o}={},a){let r=n?{ip:n}:void 0,p={...a,...o&&{headers:V(a?.headers,{"User-Agent":o})},responseType:"json"};return t.get(`/api/v2/videos/${e}/playback-urls`,r,p)},...Je(t),...ze(t),...Qe(t),listDeleted(e={},n={}){let o={endpoint:"/api/v2/videos/deleted",totalKey:"totalVideos",hitsKey:"deletedVideos",async request(r,p,c){return await t.session.queueRequest("searchVideos"),t.get(r,p,c)}};return new f(t,o,e,n)},async trim(e,n){return await t.session.queueRequest("uploadVideo"),t.post(`/api/v2/videos/${e}/trim`,n)},async convertDualStreamToSwitched(e){return await t.session.queueRequest("updateVideo"),t.put(`/api/v2/videos/${e}/convert-dual-streams-to-switched-stream`)},async edit(e,n,o){return await t.session.queueRequest("uploadVideo"),t.post(`/api/v2/videos/${e}/edit`,n,o)},async patch(e,n,o){await t.session.queueRequest("updateVideo"),await t.patch(`/api/v2/videos/${e}`,n,o)},async generateMetadata(e,n=["all"],o){await t.session.queueRequest("updateVideo"),await t.put(`/api/v2/videos/${e}/generate-metadata`,{metadataGenerationFields:n},o)},async generateMetadataStatus(e,n){let{description:o}=await t.get(`/api/v2/videos/${e}/metadata-generation-status`,void 0,{...n,responseType:"json"});return o.status},async transcribe(e,n,o){let a=typeof n=="string"?{language:n}:n;return t.post(`/api/v2/videos/${e}/transcription`,a,{...o,responseType:"json"})},async transcriptionStatus(e,n,o){return t.get(`/api/v2/videos/${e}/transcriptions/${n}/status`,void 0,{...o,responseType:"json"})},async translate(e,n,o,a){let r={sourceLanguage:n,targetLanguages:typeof o=="string"?[o]:o};return t.post(`/api/v2/videos/${e}/translations`,r,{...a,responseType:"json"})},async getTranslationStatus(e,n,o){let{status:a}=await t.get(`/api/v2/videos/${e}/translations/${n}/status`,void 0,{...o,responseType:"json"});return a},async deleteTranscription(e,n,o){let a=Array.isArray(n)?n.map(r=>r.trim()).join(","):n;await t.delete(`/api/v2/videos/${e}`,a?{locale:a}:void 0,o)},async setAudioLanguage(e,n,o,a){let{id:r,audioTracks:p=[]}=typeof e=="string"?{id:e}:e,c=o??p.findIndex(l=>l.isDefault===!0)??0,u={op:"replace",path:`/audioTracks/${c}`,value:{track:c,languageId:n}};await s.patch(r,[u],a)},async patchAudioTracks(e,n,o){let{id:a,audioTracks:r}=typeof e=="string"?await t.video.details(e):e,p=new Map(r.map(({languageName:u,...l})=>[l.track,l]));for(let{op:u,languageId:l,track:m,value:g}of n){if(u==="add"){if(l??(l=g?.languageId),!l)throw new TypeError("value languageId is required when adding audioTrack");let h={isDefault:g?.isDefault??!1,languageId:l,track:p.size,status:"Adding"};p.set(h.track,h);continue}let d=m!=null&&p.has(m)?p.get(m):[...p.values()].find(h=>h.languageId===l);if(!d&&r.length===1&&(d=p.get(r[0].track)),!d)throw new Error(`Attempt to ${u} audioTrack language ${l} ${m}, but no matching track found`);Object.assign(d,{...g,status:u==="remove"?"Deleting":"Updating"})}let c={op:"replace",path:"/audioTracks",value:[...p.values()]};return s.patch(a,[c],o)},async waitTranscode(e,n={},o){let{pollIntervalSeconds:a=30,timeoutMinutes:r=240,signal:p,ignorePlaybackWhileTranscoding:c=!0,onProgress:u,onError:l=R=>{throw R}}=n,m=1e3*60,g=Date.now()+r*m||1/0,d=Math.max((a||30)*1e3,5e3),h={status:"UploadFailed"};for(;Date.now()<g&&!p?.aborted;){try{h=await s.status(e,n);let{isProcessing:R,overallProgress:b=0,status:P}=h;if(c&&P==="Ready"&&R&&(P="Processing"),P==="ProcessingFailed"&&(b=1,R=!1),Object.assign(h,{status:P,overallProgress:b,isProcessing:R}),u?.(h),b===1&&!R)break}catch(R){await Promise.resolve(l(R))}await _(d,p)}return h}};return s}function Ze(t,i){let s=["scrollId","statusCode","statusDescription"];return Object.fromEntries(Object.entries(t).filter(([n,o])=>!(n===i||s.includes(n)||Array.isArray(o))))}var oe=class extends f{constructor(i,s,e={},n={}){let o={endpoint:`/api/v2/scheduled-events/${s}/real-time/attendees`,totalKey:"total",hitsKey:"attendees",request:async(a,r,p)=>{await i.session.queueRequest("attendeesRealtime");let c=await i.post(a,r,p),u=Ze(c,"attendees");return Object.assign(this.summary,u),c}};super(i,o,e,n),this.summary={}}async getSummary(){return this.options.maxResults=0,await this.nextPage(),this.summary}},re=class extends f{constructor(i,s,e={}){let{eventId:n,runNumber:o}=s,a=o&&o>=0?{runNumber:o}:{},r={endpoint:`/api/v2/scheduled-events/${n}/post-event-report`,totalKey:"totalSessions",hitsKey:"sessions",request:async(p,c,u)=>{let l=await i.request("GET",p,c,{...u,responseType:"json",throwHttpErrors:!1});return await this._assertResponseOk(l),Object.assign(this.summary,Ze(l.body,"sessions")),l.body}};super(i,r,a,e),this.summary={}}async _assertResponseOk({response:i,statusCode:s,body:e}){if(i.ok)return e;throw s==400&&e?.errorDescription?new S(i,{details:e.errorDescription}):e||i.bodyUsed?new S(i,e):await S.create(i)}async getSummary(){return this.options.maxResults=0,await this.nextPage(),this.summary}};function ae(t){let i={async list(s={},e){return t.get("/api/v2/scheduled-events",s,{...e,responseType:"json"})},search(s,e){let n={endpoint:"/api/v2/search/scheduled-events",totalKey:"total",hitsKey:"events",request:(o,a,r)=>t.post(o,a,r),isPost:!0};return new f(t,n,s,e)},async create(s){let{eventId:e}=await t.post("/api/v2/scheduled-events",s);return e},async details(s,e){return t.get(`/api/v2/scheduled-events/${s}`,void 0,e)},async edit(s,e){return t.put(`/api/v2/scheduled-events/${s}`,e)},async patch(s,e,n){await t.patch(`/api/v2/scheduled-events/${s}`,e,n)},async delete(s){return t.delete(`/api/v2/scheduled-events/${s}`)},async editAccess(s,e){return t.put(`/api/v2/scheduled-events/${s}/access-control`,e)},attendees(s,e,n){return new re(t,{eventId:s,runNumber:e},n)},realtimeAttendees(s,e,n){return new oe(t,s,e,n)},async questions(s,e){let n=(e??-1)>=0?{runNumber:e}:{};return t.get(`/api/v2/scheduled-events/${s}/questions`,n,{responseType:"json"})},async pollResults(s,e){let n=(e??-1)>=0?{runNumber:e}:{},o=await t.get(`/api/v2/scheduled-events/${s}/poll-results`,n,{responseType:"text"}),{polls:a=[]}=o?JSON.parse(o):{};return a},async comments(s,e){let n=(e??-1)>=0?{runNumber:e}:{};return t.get(`/api/v2/scheduled-events/${s}/comments`,n,{responseType:"json"})},async reactions(s){return t.get(`/api/v2/scheduled-events/${s}/reactions`,void 0,{responseType:"json"})},async status(s,e){return t.get(`/api/v2/scheduled-events/${s}/status`,void 0,e)},async isPublic(s,e){let n=await t.request("GET",`/api/v2/scheduled-events/${s}/is-public`,void 0,{...e,throwHttpErrors:!1,responseType:"json"});return n.statusCode!==401&&n.body?.isPublic},async bulkDelete(s,e){let{body:n}=await t.request("DELETE","/api/v2/scheduled-events",s,e);return n},bulkDeleteStatus(s){return t.get(`/api/v2/scheduled-events/delete-status/${s}`)},async playbackUrls(s,{ip:e,userAgent:n}={},o){let a=e?{ip:e}:void 0,r={...o,...n&&{headers:V(o?.headers,{"User-Agent":n})},responseType:"json"};return t.get(`/api/v2/scheduled-events/${s}/playback-url`,a,r)},async playbackUrl(s,e={}){t.log("debug","webcast.playbackUrl is deprecated - use webcast.playbackUrls instead");let{playbackResults:n}=await i.playbackUrls(s,e);return n},async startEvent(s,e=!1){await t.put(`/api/v2/scheduled-events/${s}/start`,{preProduction:e})},async stopEvent(s,e=!1){await t.delete(`/api/v2/scheduled-events/${s}/start`,{preProduction:e})},async startBroadcast(s){await t.put(`/api/v2/scheduled-events/${s}/broadcast`)},async stopBroadcast(s){await t.delete(`/api/v2/scheduled-events/${s}/broadcast`)},async startRecord(s){await t.put(`/api/v2/scheduled-events/${s}/record`)},async stopRecord(s){await t.delete(`/api/v2/scheduled-events/${s}/record`)},async linkVideo(s,e,n=!0){let o={videoId:e,redirectVod:n};return t.put(`/api/v2/scheduled-events/${s}/linked-video`,o)},async unlinkVideo(s){return t.delete(`/api/v2/scheduled-events/${s}/linked-video`)},async guestRegistration(s,e){return t.get(`/api/v2/scheduled-events/${s}/registrations/${e}`)},async muteAttendee(s,e,n){let o=(n??-1)>=0?{runNumber:n}:{};await t.put(`/api/v2/scheduled-events/${s}/users/${e}/mute`,o)},async unmuteAttendee(s,e,n){let o=(n??-1)>=0?{runNumber:n}:{};await t.delete(`/api/v2/scheduled-events/${s}/users/${e}/mute`,o)},async hideComment(s,e,n){let o=(n??-1)>=0?{runNumber:n}:{};await t.put(`/api/v2/scheduled-events/${s}/comments/${e}/hide`,o)},async unhideComment(s,e,n){let o=(n??-1)>=0?{runNumber:n}:{};await t.delete(`/api/v2/scheduled-events/${s}/comments/${e}/hide`,o)},async createGuestRegistration(s,e){return t.post(`/api/v2/scheduled-events/${s}/registrations`,e)},listGuestRegistrations(s,e={},n){let o={endpoint:`/api/v2/scheduled-events/${s}/registrations`,totalKey:"total",hitsKey:"guestUsers"};return new f(t,o,e,n)},updateGuestRegistration(s,e,n){return t.put(`/api/v2/scheduled-events/${s}/registrations/${e}`,n)},patchGuestRegistration(s,e,n){let o=Object.entries(n).map(([a,r])=>({op:"replace",path:`/${ke(a)}`,value:r}));return t.put(`/api/v2/scheduled-events/${s}/registrations/${e}`,o)},deleteGuestRegistration(s,e){return t.delete(`/api/v2/scheduled-events/${s}/registrations/${e}`)},resendEmailToExternalPresenter(s,e){return t.post(`/api/v2/scheduled-events/${s}/presenter-resend-email?email=${encodeURIComponent(e)}`)},async listEmbeddedEngagements(s){let{contentLinks:e}=await t.get(`/api/v2/scheduled-events/${s}/embedded-content/links`);return e||[]},addEmbeddedEngagement(s,e){return t.post(`/api/v2/scheduled-events/${s}/embedded-content/link`,e)},setEmbeddedEngagementStatus(s,e,n){return t.put(`/api/v2/scheduled-events/${s}/embedded-content/links/${e}/status`,{isEnabled:n})},updateEmbeddedEngagement(s,e){let{id:n,...o}=e;return t.put(`/api/v2/scheduled-events/${s}/embedded-content/links/${n}`,o)},deleteEmbeddedEngagement(s,e){return t.delete(`/api/v2/scheduled-events/${s}/embedded-content/links/${e}`)},async listBanners(s){let{banners:e}=await t.get(`/api/v2/scheduled-events/${s}/banners`);return e||[]},addBanner(s,e){return t.post(`/api/v2/scheduled-events/${s}/banner`,e)},setBannerStatus(s,e,n){return t.put(`/api/v2/scheduled-events/${s}/banner/${e}/status`,{isEnabled:n})},updateBanner(s,e){let{id:n,...o}=e;return t.put(`/api/v2/scheduled-events/${s}/banner/${n}`,o)},deleteBanner(s,e){return t.delete(`/api/v2/scheduled-events/${s}/banner/${e}`)},get uploadBranding(){return t.upload.webcastBranding},get uploadPresentation(){return t.upload.webcastPresentation},get uploadBackgroundImage(){return t.upload.webcastBackground},deleteBackgroundImage(s){return t.delete(`/api/v2/scheduled-events/${s}/background-image`)},get uploadProducerLayoutBackground(){return t.upload.webcastProducerLayoutBackground},deleteProducerLayoutBackground(s){return t.delete(`/api/v2/scheduled-events/${s}/webcast-producer-bgimage`)}};return i}function pe(t){let i={async list(){return t.get("/api/v2/zones",void 0,{responseType:"json"})},async flatList(){let{defaultZone:s,zones:e}=await i.list(),n=[s];function o(a){let{childZones:r=[],...p}=a;n.push(p),r.forEach(o)}return e.forEach(o),n},async create(s){let{zoneId:e}=await t.post("/api/v2/zones",s,{responseType:"json"});return e},async edit(s,e){return t.put(`/api/v2/zones/${s}`,e)},delete(s){return t.delete(`/api/v2/zones/${s}`)},get devices(){return t.device.listZoneDevices}};return i}function ce(t){let i="",s="",e;return{async getAccountId(o=!1){if(!i||o){let a=await t.get("/",void 0,{responseType:"text"}).catch(r=>"");i=(/BootstrapContext.*account[":{ ]*"id"\s*:\s*"([^"]+)"/.exec(a)||[])[1]||""}return i},async getRevVersion(o=!1){if(!s||o){let a=await t.get("/js/version.js",void 0,{responseType:"text"}).catch(r=>"");s=(/buildNumber:\s+['"]([\d.]+)/.exec(a)||[])[1]||""}return s},async getUserLocalIp(o=1e4,a=!1){if((!e||a)&&(e=await t.get("/api/v2/user-location")),!e?.enabled||e.locationUrls.length===0)return;let r=new AbortController,p=async function(u){try{let{ip:l=""}=await t.get(u,{},{headers:{Authorization:""},responseType:"json",signal:r.signal});return l=`${l}`.split(",")[0].trim(),l&&r.abort(),l}catch(l){t.log("debug",`ULS URL Failed: ${u}`,l);return}},c=setTimeout(()=>r.abort(),o);try{return(await Promise.all(e.locationUrls.map(p))).find(l=>!!l)}finally{clearTimeout(c)}}}}var W=1e3*60,bt=10,I=Symbol("credentials"),ue=class{constructor(i,s={}){this._isExtending=!1;this.extendOptions={extendThresholdMilliseconds:3*W,keepAliveInterval:10*W,verify:!0,...s},Object.defineProperties(this,{_session:{get:()=>i,enumerable:!1}})}getNextExtendTime(){let{expires:i}=this._session;if(!i)return 0;let{keepAliveInterval:s,extendThresholdMilliseconds:e}=this.extendOptions,n=5*1e3,o=i.getTime()-Date.now();return Math.max(n,Math.min(o-e,s))}async _poll(){let{_session:i}=this,s=this._reset(),{signal:e}=s;for(;i.isConnected&&!e.aborted;){let n=this.getNextExtendTime();if(await _(n,e),e.aborted)break;try{this._isExtending=!0,await i.lazyExtend(this.extendOptions)}catch(o){s.abort(),this.error=o}finally{this._isExtending=!1}}}start(){this._isExtending||this._poll()}stop(){this._isExtending||this.controller&&this.controller.abort()}_reset(){this.error=void 0,this._isExtending=!1;let i=this.controller;return this.controller=new y.AbortController,i&&i.abort(),this.controller}get isAlive(){return this.controller&&!this.controller.signal.aborted}};I;var q=class{constructor(i,s,e,n){this.expires=new Date,e===!0?this.keepAlive=new ue(this):v(e)&&(this.keepAlive=new ue(this,e));let o;n&&(o=_e(v(n)?n:void 0)),Object.defineProperties(this,{rev:{get(){return i},enumerable:!1},[I]:{get(){return s},enumerable:!1},_rateLimits:{get(){return o},enumerable:!1}})}async login(){this.token=void 0,this.expires=new Date;let{expiration:i,...s}=await this._login();Object.assign(this,s);let e=new Date(i);isNaN(e.getTime())||e.getTime()<this.expires.getTime()?this.expires.setUTCMinutes(this.expires.getUTCMinutes()+bt):this.expires=e,this.keepAlive&&this.keepAlive.start()}async extend(){let{expiration:i}=await this._extend();this.expires=new Date(i)}async logoff(){this.keepAlive&&this.keepAlive.stop();try{await this._logoff()}finally{this.token=void 0,this.expires=new Date}}async verify(){try{return await this.rev.auth.verifySession(),!0}catch{return!1}}async lazyExtend(i={}){let{extendThresholdMilliseconds:s=3*W,verify:e=!0}=i,{expires:n}=this,o=n?n.getTime()-Date.now():-1;if(o<=0)return await this.login(),!0;if(o>s)try{return await this.extend(),!0}catch(a){this.rev.log("warn","Error extending session - re-logging in",a)}else if(!e||await this.verify())return!1;return await this.login(),!0}async queueRequest(i){await this._rateLimits?.[i]?.()}async clearQueues(i){await je(this._rateLimits??{},i)}get isExpired(){let{expires:i}=this;return i?Date.now()>i.getTime():!0}get isConnected(){return!!this.token&&!this.isExpired}get username(){return this[I].username}get hasRateLimits(){return!!this._rateLimits}},we=class extends q{async _login(){let{oauthConfig:i,authCode:s}=this[I];if(!i||!s)throw new TypeError("OAuth Config / auth code not specified");let{accessToken:e,expiration:n,refreshToken:o,userId:a}=await this.rev.auth.loginOAuth(i,s);return{token:e,expiration:n,refreshToken:o,userId:a}}async _extend(){let{[I]:{oauthConfig:i}}=this,{accessToken:s,expiration:e,refreshToken:n}=await this.rev.auth.extendSessionOAuth(i,this.refreshToken);return Object.assign(this,{token:s,refreshToken:n}),{expiration:e}}async _logoff(){}toJSON(){return{token:this.token||"",expiration:this.expires,refreshToken:this.refreshToken}}},Te=class extends q{async _login(){let{oauthConfig:i,code:s,codeVerifier:e}=this[I];if(!i||!s||!e)throw new TypeError("OAuth Config / auth code / verifier not specified");let{access_token:n,expires_in:o,refresh_token:a,userId:r}=await this.rev.auth.loginOAuth2(i,s,e),p=Date.now()+parseInt(o,10)*1e3,c=new Date(p).toISOString();return{token:n,expiration:c,refreshToken:a,userId:r}}async _extend(){return this.rev.auth.extendSession()}async _logoff(){}toJSON(){return{token:this.token||"",expiration:this.expires}}},xe=class extends q{async _login(){let{username:i,password:s}=this[I];if(!i||!s)throw new TypeError("username/password not specified");let{token:e,expiration:n,id:o}=await this.rev.auth.loginUser(i,s);return{token:e,expiration:n,userId:o}}async _extend(){let{userId:i}=this;return this.rev.auth.extendSessionUser(i)}async _logoff(){let{userId:i}=this;return this.rev.auth.logoffUser(i)}toJSON(){return{token:this.token||"",expiration:this.expires,userId:this.userId}}},Ae=class extends q{async _login(){let{apiKey:i,secret:s}=this[I];if(!i||!s)throw new TypeError("apiKey/secret not specified");return this.rev.auth.loginToken(i,s)}async _extend(){let{apiKey:i}=this[I];return this.rev.auth.extendSessionToken(i)}async _logoff(){let{apiKey:i}=this[I];return this.rev.auth.logoffToken(i)}toJSON(){return{token:this.token||"",expiration:this.expires,apiKey:this[I].apiKey}}},Se=class extends q{async _login(){let{jwtToken:i}=this[I];if(!i)throw new TypeError("JWT Token not specified");let{accessToken:s,expiration:e}=await this.rev.auth.loginJWT(i);return{token:s,expiration:e,issuer:"vbrick"}}async _extend(){return this.rev.auth.extendSession()}async _logoff(){}toJSON(){return{token:this.token||"",expiration:this.expires}}},Oe=class extends q{async _login(){let{webcastId:i,guestRegistrationToken:s}=this[I];if(!s||!i)throw new TypeError("Guest Registration Token or Webcast ID not specified");let{accessToken:e}=await this.rev.auth.loginGuestRegistration(i,s),n=Date.now()+1e3*60*15,o=new Date(n).toISOString();return{token:e,expiration:o,issuer:"vbrick"}}async _extend(){return this.rev.auth.extendSession()}async _logoff(){}toJSON(){return{token:this.token||"",expiration:this.expires}}},Ie=class extends q{async _login(){return await this.rev.auth.verifySession(),this.expires||(this.expires=new Date(Date.now()+15*60*1e3)),{token:this.token||"",expiration:this.expires.toISOString(),issuer:"vbrick"}}async _extend(){return this.rev.auth.extendSession()}async _logoff(){}toJSON(){return{token:this.token||"",expiration:this.expires}}get isConnected(){return!0}get isExpired(){return!1}},qe=class extends q{async _login(){return this.rev.log("debug","Using client with no authentication (publicOnly) - non-public endpoints will return 401"),{token:this.token||"",expiration:new Date(Date.now()+24*60*W).toISOString(),issuer:"vbrick"}}async _extend(){return{expiration:new Date(Date.now()+24*60*W).toISOString()}}async _logoff(){}toJSON(){return{token:this.token||"",expiration:this.expires}}get isConnected(){return!0}get isExpired(){return!1}};function Ye(t,i,s,e){let n,{session:o={},publicOnly:a,...r}=i,{token:p,expiration:c,refreshToken:u,userId:l}=o,m=Date.now(),g=new Date(c||m),d=p&&typeof p=="string"&&g.getTime()>m,h=i.oauthConfig&&i.code&&i.codeVerifier,R=i.oauthConfig&&(i.authCode||d&&u),b=i.apiKey&&(i.secret||d&&!l),P=i.username&&(i.password||d&&l),x=i.jwtToken,C=i.webcastId&&i.guestRegistrationToken;if(h)n=new Te(t,r,s,e);else if(R)n=new we(t,r,s,e),u&&(n.refreshToken=u);else if(b)n=new Ae(t,r,s,e);else if(x)n=new Se(t,r,s,e);else if(C)n=new Oe(t,r,s,e);else if(P)n=new xe(t,r,s,e),l&&(n.userId=l);else if(a)n=new qe(t,r,!1,e);else if(d)n=new Ie(t,r,s,e);else throw new TypeError("Must specify credentials (username+password, apiKey+secret or oauthConfig+authCode)");return d&&(n.token=p,n.expires=g),n}var G=class{constructor(i){if(!v(i)||!i.url)throw new TypeError("Missing configuration options for client - url and username/password or apiKey/secret");let{url:s,log:e,logEnabled:n=!1,keepAlive:o=!0,rateLimits:a=!1,defaultStreamPreference:r="stream",...p}=i,c=new URL(s);this.url=c.origin,this.session=Ye(this,p,o,a),this.logEnabled=!!n,e&&(this.log=(u,...l)=>{this.logEnabled&&e(u,...l)}),this._streamPreference=r,Object.defineProperties(this,{admin:{value:H(this),writable:!1},audit:{value:M(this,a),writable:!1},auth:{value:K(this),writable:!1},category:{value:N(this),writable:!1},channel:{value:z(this),writable:!1},device:{value:J(this),writable:!1},environment:{value:ce(this),writable:!1},group:{value:Q(this),writable:!1},playlist:{value:Y(this),writable:!1},recording:{value:X(this),writable:!1},upload:{value:ee(this),writable:!1},user:{value:te(this),writable:!1},video:{value:ie(this),writable:!1},webcast:{value:ae(this),writable:!1},webcasts:{get:()=>(this.log("debug","webcasts is deprecated - use rev.webcast instead"),this.webcast),enumerable:!1},zones:{value:pe(this),writable:!1}})}async request(i,s,e=void 0,n={}){De()&&await Ce();let o=new URL(s,this.url);if(o.origin!==this.url)throw new TypeError(`Invalid endpoint - must be relative to ${this.url}`);let{headers:a,responseType:r,throwHttpErrors:p=!0,...c}=n,u=new y.Headers(a);this.session.token&&!u.has("Authorization")&&u.set("Authorization",`VBrick ${this.session.token}`),u.get("Authorization")===""&&u.delete("Authorization");let l={mode:"cors",method:i,...c,headers:u},m=!u.has("Content-Type"),g=i.toUpperCase();if(e)if(["POST","PUT","PATCH"].includes(g))typeof e=="string"?l.body=e:e instanceof y.FormData?(m=!1,l.body=e):v(e)||Array.isArray(e)?l.body=JSON.stringify(e):l.body=e;else if(v(e))for(let[C,Xe]of Object.entries(e))o.searchParams.append(C,Xe);else throw new TypeError(`Invalid payload for request to ${i} ${s}`);if(u.has("Accept")||u.set("Accept","application/json"),m&&l.body&&u.set("Content-Type","application/json"),this.log("debug",`Request ${i} ${s}`),this.session.hasRateLimits)switch(g){case"GET":await this.session.queueRequest("get");break;case"POST":case"PATCH":case"PUT":case"DELETE":await this.session.queueRequest("post");break}let d=await y.fetch(`${o}`,{...l,method:i,headers:u}),{ok:h,status:R,statusText:b,headers:P}=d;if(!h){if(p){let C=await S.create(d);throw this.log("debug",`Response ${i} ${s} ${R} ${C.code||b}`),C}r=void 0}this.log("debug",`Response ${i} ${s} ${R} ${b}`);let x=d.body;switch(r){case"json":`${P.get("content-length")}`=="0"?x=null:x=await d.json();break;case"text":x=await d.text();break;case"blob":x=await d.blob();break;case"stream":switch(this._streamPreference){case"webstream":x=y.asWebStream(d.body);break;case"nativestream":x=y.asPlatformStream(d.body);break;default:x=d.body}x=d.body;break;case"webstream":x=y.asWebStream(d.body);break;case"nativestream":x=y.asPlatformStream(d.body);break;default:x=await Ge(d,u.get("Accept"))}return{statusCode:R,headers:P,body:x,response:d}}async get(i,s,e){let{body:n}=await this.request("GET",i,s,e);return n}async post(i,s,e){let{body:n}=await this.request("POST",i,s,e);return n}async put(i,s,e){let{body:n}=await this.request("PUT",i,s,e);return n}async patch(i,s,e){await this.request("PATCH",i,s,e)}async delete(i,s,e){await this.request("DELETE",i,s,e)}async connect(){await We(()=>this.session.login(),i=>![401,429].includes(i.status))}async disconnect(){try{await this.session.logoff()}catch(i){this.log("warn",`Error in logoff, ignoring: ${i}`)}}async extendSession(){return this.session.extend()}async verifySession(){return this.session.verify()}get isConnected(){return this.session.isConnected}get token(){return this.session.token}get sessionExpires(){return this.session.expires}get sessionState(){return this.session.toJSON()}set sessionState(i){this.session.token=`${i.token}`,this.session.expires=new Date(i.expiration);for(let s of["apiKey","refreshToken","userId"])s in i&&(this.session[s]=`${i[s]||""}`)}log(i,...s){if(!this.logEnabled)return;let e=new Date().toJSON().replace("T"," ").slice(0,-5);console.debug(`${e} REV-CLIENT [${i}]`,...s)}};var Pt={rateLimit:L,getExtensionForMime:ge,getMimeForExtension:me,setPolyfills:Ue},wt=G;return ot(Tt);})();
//# sourceMappingURL=rev-client.iife.js.map